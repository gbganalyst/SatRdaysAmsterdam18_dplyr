<!DOCTYPE html>
<html>
  <head>
    <title>Getting more out of dplyr</title>
    <meta charset="utf-8">
    <meta name="author" content="Suzan Baert" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="css\my-fonts.css" type="text/css" />
    <link rel="stylesheet" href="css\my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Getting more out of dplyr
## <br/>sample code
### Suzan Baert

---




class: middle

# Getting more out of dplyr 
# Code examples




---

## The variables of this survey data set

A large mess.... (and this is a really short survey...)


```r
glimpse(raw_surveydata)
```

```
## Observations: 126
## Variables: 29
## $ Timestamp                                                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `Thinking about the last month or so, what are the packages you loaded the most when using R? Please answer max 10 packages you've actively called (not dependencies) and separate using commas.`                                                                   &lt;chr&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [Rcpp]`                                                                    &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [stringi]`                                                                 &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [ggplot2]`                                                                 &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [glue]`                                                                    &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [rlang]`                                                                   &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [stringr]`                                                                 &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [dplyr]`                                                                   &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [pillar]`                                                                  &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [fansi]`                                                                   &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [tibble]`                                                                  &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [utf8]`                                                                    &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [jsonlite]`                                                                &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [curl]`                                                                    &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [purrr]`                                                                   &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [data.table]`                                                              &lt;fct&gt; ...
## $ `Specifically about dplyr: can you list below all dplyr functions you can spontaneously think of right now? Separate using commmas. If you don't use dplyr, leave this question blank. And to everyone else, no peeking to documentation or scripts please ;)`      &lt;chr&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Do or not do. There is no try." (Yoda)]`                                                                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["It does not matter what people call you unless they call you pigeon pie and eat you up." (Evelyn Waugh)]`       &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Get your facts first, then you can distort them as you please." (Mark Twain)]`                                  &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["You should laugh every moment you live, for you'll find it decidedly difficult afterwards." (Joe Abercrombie)]` &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["I love deadlines. I love the whooshing noise they make as they go by." (Douglas Adams)]`                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Behind every great man is a woman rolling her eyes." (Jim Carrey)]`                                             &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Winter is coming." (George RR Martin)]`                                                                         &lt;fct&gt; ...
## $ `How many years have you been using R? Please enter the number of years below. If less than a year, you can use decimals (e.g. 0.5 for months)`                                                                                                                     &lt;dbl&gt; ...
## $ `In which continent do you currently live?`                                                                                                                                                                                                                         &lt;chr&gt; ...
## $ `Which generation do you belong to?`                                                                                                                                                                                                                                &lt;chr&gt; ...
## $ `Which month do you celebrate your birthday?`                                                                                                                                                                                                                       &lt;chr&gt; ...
```


---

## The variables of this survey data set

(Page2)


```r
glimpse(raw_surveydata[18:29])
```

```
## Observations: 126
## Variables: 12
## $ `Specifically about dplyr: can you list below all dplyr functions you can spontaneously think of right now? Separate using commmas. If you don't use dplyr, leave this question blank. And to everyone else, no peeking to documentation or scripts please ;)`      &lt;chr&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Do or not do. There is no try." (Yoda)]`                                                                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["It does not matter what people call you unless they call you pigeon pie and eat you up." (Evelyn Waugh)]`       &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Get your facts first, then you can distort them as you please." (Mark Twain)]`                                  &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["You should laugh every moment you live, for you'll find it decidedly difficult afterwards." (Joe Abercrombie)]` &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["I love deadlines. I love the whooshing noise they make as they go by." (Douglas Adams)]`                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Behind every great man is a woman rolling her eyes." (Jim Carrey)]`                                             &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Winter is coming." (George RR Martin)]`                                                                         &lt;fct&gt; ...
## $ `How many years have you been using R? Please enter the number of years below. If less than a year, you can use decimals (e.g. 0.5 for months)`                                                                                                                     &lt;dbl&gt; ...
## $ `In which continent do you currently live?`                                                                                                                                                                                                                         &lt;chr&gt; ...
## $ `Which generation do you belong to?`                                                                                                                                                                                                                                &lt;chr&gt; ...
## $ `Which month do you celebrate your birthday?`                                                                                                                                                                                                                       &lt;chr&gt; ...
```


---

## Current variable names

To fit on the screen... 


```r
raw_surveydata_short &lt;- select(raw_surveydata, 1:4, 18:20, 25:29)
glimpse(raw_surveydata_short)
```

```
## Observations: 126
## Variables: 12
## $ Timestamp                                                                                                                                                                                                                                                      &lt;chr&gt; ...
## $ `Thinking about the last month or so, what are the packages you loaded the most when using R? Please answer max 10 packages you've actively called (not dependencies) and separate using commas.`                                                              &lt;chr&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [Rcpp]`                                                               &lt;fct&gt; ...
## $ `I've taken a set of frequently downloaded packages (as per cran logs on Harry Potter's most recent birthday). From the below set, how often do you load functions from these packages?  [stringi]`                                                            &lt;fct&gt; ...
## $ `Specifically about dplyr: can you list below all dplyr functions you can spontaneously think of right now? Separate using commmas. If you don't use dplyr, leave this question blank. And to everyone else, no peeking to documentation or scripts please ;)` &lt;chr&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Do or not do. There is no try." (Yoda)]`                                                                   &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["It does not matter what people call you unless they call you pigeon pie and eat you up." (Evelyn Waugh)]`  &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Winter is coming." (George RR Martin)]`                                                                    &lt;fct&gt; ...
## $ `How many years have you been using R? Please enter the number of years below. If less than a year, you can use decimals (e.g. 0.5 for months)`                                                                                                                &lt;dbl&gt; ...
## $ `In which continent do you currently live?`                                                                                                                                                                                                                    &lt;chr&gt; ...
## $ `Which generation do you belong to?`                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `Which month do you celebrate your birthday?`                                                                                                                                                                                                                  &lt;chr&gt; ...
```


---

class: middle

# Part 1
# Modifying variable names

---

## dplyr refresher: 

select() only keeps the variables you specify.


```r
raw_surveydata_short %&gt;% 
  select(`Which generation do you belong to?`, 
         `Which month do you celebrate your birthday?`) %&gt;% 
  glimpse()
```

```
## Observations: 126
## Variables: 2
## $ `Which generation do you belong to?`          &lt;chr&gt; "Millenials ", "...
## $ `Which month do you celebrate your birthday?` &lt;chr&gt; "July", "June", ...
```


---

## dplyr refresher: 

You can rename a variable inside your select() statement


```r
raw_surveydata_short %&gt;% 
  select(generation = `Which generation do you belong to?`, 
         month_born = `Which month do you celebrate your birthday?`) %&gt;% 
  glimpse()
```

```
## Observations: 126
## Variables: 2
## $ generation &lt;chr&gt; "Millenials ", "Generation X ", "Millenials ", "Gen...
## $ month_born &lt;chr&gt; "July", "June", "June", "January", "July", "March",...
```


---

class: inverse, center, middle

## select_all(data, function_y)

select and rename all variable names using function_y


---


## Select_all to modify all variable names with tolower()



```r
raw_surveydata_short %&gt;% 
* select_all(tolower) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 12
## $ timestamp                                                                                                                                                                                                                                                      &lt;chr&gt; ...
## $ `thinking about the last month or so, what are the packages you loaded the most when using r? please answer max 10 packages you've actively called (not dependencies) and separate using commas.`                                                              &lt;chr&gt; ...
## $ `i've taken a set of frequently downloaded packages (as per cran logs on harry potter's most recent birthday). from the below set, how often do you load functions from these packages?  [rcpp]`                                                               &lt;fct&gt; ...
## $ `i've taken a set of frequently downloaded packages (as per cran logs on harry potter's most recent birthday). from the below set, how often do you load functions from these packages?  [stringi]`                                                            &lt;fct&gt; ...
## $ `specifically about dplyr: can you list below all dplyr functions you can spontaneously think of right now? separate using commmas. if you don't use dplyr, leave this question blank. and to everyone else, no peeking to documentation or scripts please ;)` &lt;chr&gt; ...
## $ `below are some quotes taken from brainyquote.com or from my private collection. can you indicate how much you agree or disagree with each quote? ["do or not do. there is no try." (yoda)]`                                                                   &lt;fct&gt; ...
## $ `below are some quotes taken from brainyquote.com or from my private collection. can you indicate how much you agree or disagree with each quote? ["it does not matter what people call you unless they call you pigeon pie and eat you up." (evelyn waugh)]`  &lt;fct&gt; ...
## $ `below are some quotes taken from brainyquote.com or from my private collection. can you indicate how much you agree or disagree with each quote? ["winter is coming." (george rr martin)]`                                                                    &lt;fct&gt; ...
## $ `how many years have you been using r? please enter the number of years below. if less than a year, you can use decimals (e.g. 0.5 for months)`                                                                                                                &lt;dbl&gt; ...
## $ `in which continent do you currently live?`                                                                                                                                                                                                                    &lt;chr&gt; ...
## $ `which generation do you belong to?`                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `which month do you celebrate your birthday?`                                                                                                                                                                                                                  &lt;chr&gt; ...
```

---


## Select_all to modify all variable names with tolower()

Note that the observations itself are not modified.


```r
raw_surveydata_short %&gt;% 
* select_all(tolower)
```

```
## # A tibble: 126 x 12
##    timestamp  `thinking about the~ `i've taken a set ~ `i've taken a set ~
##    &lt;chr&gt;      &lt;chr&gt;                &lt;fct&gt;               &lt;fct&gt;              
##  1 2018/08/1~ dplyr, readxl, json~ Never               Never              
##  2 2018/08/1~ tidyverse, broom, l~ Never               Never              
##  3 2018/08/1~ Tidyverse, recipes,~ Usually             About half the time
##  4 2018/08/1~ &lt;NA&gt;                 Seldom              About half the time
##  5 2018/08/1~ Ggplot2, reshape2, ~ Never               Seldom             
##  6 2018/08/1~ Tidyverse, here, pl~ Seldom              Never              
##  7 2018/08/1~ Tidyverse, odbc, db~ Usually             Usually            
##  8 2018/08/1~ dplyr, scales, ggre~ Never               Never              
##  9 2018/08/1~ dplyr, ggplot2, kni~ Seldom              Seldom             
## 10 2018/08/1~ Dplyr, purrr, furrr~ Seldom              Seldom             
## # ... with 116 more rows, and 8 more variables: `specifically about dplyr:
## #   can you list below all dplyr functions you can spontaneously think of
## #   right now? separate using commmas. if you don't use dplyr, leave this
## #   question blank. and to everyone else, no peeking to documentation or
## #   scripts please ;)` &lt;chr&gt;, `below are some quotes taken from
## #   brainyquote.com or from my private collection. can you indicate how
## #   much you agree or disagree with each quote? ["do or not do. there is
## #   no try." (yoda)]` &lt;fct&gt;, `below are some quotes taken from
## #   brainyquote.com or from my private collection. can you indicate how
## #   much you agree or disagree with each quote? ["it does not matter what
## #   people call you unless they call you pigeon pie and eat you up."
## #   (evelyn waugh)]` &lt;fct&gt;, `below are some quotes taken from
## #   brainyquote.com or from my private collection. can you indicate how
## #   much you agree or disagree with each quote? ["winter is coming."
## #   (george rr martin)]` &lt;fct&gt;, `how many years have you been using r?
## #   please enter the number of years below. if less than a year, you can
## #   use decimals (e.g. 0.5 for months)` &lt;dbl&gt;, `in which continent do you
## #   currently live?` &lt;chr&gt;, `which generation do you belong to?` &lt;chr&gt;,
## #   `which month do you celebrate your birthday?` &lt;chr&gt;
```


---

## Select_all to replace spaces with underscores


```r
raw_surveydata_short %&gt;% 
  select_all(tolower) %&gt;% 
* select_all(str_replace_all(., " ", "_")) %&gt;%
  glimpse()
```

.remark-inline-code[Error: .funs must contain one renaming function, not 12]

---

## Select_all to replace spaces with underscores

Making a function on the fly: ~


```r
raw_surveydata %&gt;% 
  select_all(tolower) %&gt;% 
* select_all(~str_replace_all(., " ", "_")) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 29
## $ timestamp                                                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `thinking_about_the_last_month_or_so,_what_are_the_packages_you_loaded_the_most_when_using_r?_please_answer_max_10_packages_you've_actively_called_(not_dependencies)_and_separate_using_commas.`                                                                   &lt;chr&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[rcpp]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[stringi]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[ggplot2]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[glue]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[rlang]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[stringr]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[dplyr]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[pillar]`                                                                  &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[fansi]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[tibble]`                                                                  &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[utf8]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[jsonlite]`                                                                &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[curl]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[purrr]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[data.table]`                                                              &lt;fct&gt; ...
## $ `specifically_about_dplyr:_can_you_list_below_all_dplyr_functions_you_can_spontaneously_think_of_right_now?_separate_using_commmas._if_you_don't_use_dplyr,_leave_this_question_blank._and_to_everyone_else,_no_peeking_to_documentation_or_scripts_please_;)`      &lt;chr&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["do_or_not_do._there_is_no_try."_(yoda)]`                                                                        &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["it_does_not_matter_what_people_call_you_unless_they_call_you_pigeon_pie_and_eat_you_up."_(evelyn_waugh)]`       &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["get_your_facts_first,_then_you_can_distort_them_as_you_please."_(mark_twain)]`                                  &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["you_should_laugh_every_moment_you_live,_for_you'll_find_it_decidedly_difficult_afterwards."_(joe_abercrombie)]` &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["i_love_deadlines._i_love_the_whooshing_noise_they_make_as_they_go_by."_(douglas_adams)]`                        &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["behind_every_great_man_is_a_woman_rolling_her_eyes."_(jim_carrey)]`                                             &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["winter_is_coming."_(george_rr_martin)]`                                                                         &lt;fct&gt; ...
## $ `how_many_years_have_you_been_using_r?_please_enter_the_number_of_years_below._if_less_than_a_year,_you_can_use_decimals_(e.g._0.5_for_months)`                                                                                                                     &lt;dbl&gt; ...
## $ `in_which_continent_do_you_currently_live?`                                                                                                                                                                                                                         &lt;chr&gt; ...
## $ `which_generation_do_you_belong_to?`                                                                                                                                                                                                                                &lt;chr&gt; ...
## $ `which_month_do_you_celebrate_your_birthday?`                                                                                                                                                                                                                       &lt;chr&gt; ...
```



---

## Select_all to replace spaces with underscores

Alternative way of making a function on the fly: funs()


```r
raw_surveydata %&gt;% 
  select_all(tolower) %&gt;% 
* select_all(funs(str_replace_all(., " ", "_"))) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 29
## $ timestamp                                                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `thinking_about_the_last_month_or_so,_what_are_the_packages_you_loaded_the_most_when_using_r?_please_answer_max_10_packages_you've_actively_called_(not_dependencies)_and_separate_using_commas.`                                                                   &lt;chr&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[rcpp]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[stringi]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[ggplot2]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[glue]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[rlang]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[stringr]`                                                                 &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[dplyr]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[pillar]`                                                                  &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[fansi]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[tibble]`                                                                  &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[utf8]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[jsonlite]`                                                                &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[curl]`                                                                    &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[purrr]`                                                                   &lt;fct&gt; ...
## $ `i've_taken_a_set_of_frequently_downloaded_packages_(as_per_cran_logs_on_harry_potter's_most_recent_birthday)._from_the_below_set,_how_often_do_you_load_functions_from_these_packages?__[data.table]`                                                              &lt;fct&gt; ...
## $ `specifically_about_dplyr:_can_you_list_below_all_dplyr_functions_you_can_spontaneously_think_of_right_now?_separate_using_commmas._if_you_don't_use_dplyr,_leave_this_question_blank._and_to_everyone_else,_no_peeking_to_documentation_or_scripts_please_;)`      &lt;chr&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["do_or_not_do._there_is_no_try."_(yoda)]`                                                                        &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["it_does_not_matter_what_people_call_you_unless_they_call_you_pigeon_pie_and_eat_you_up."_(evelyn_waugh)]`       &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["get_your_facts_first,_then_you_can_distort_them_as_you_please."_(mark_twain)]`                                  &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["you_should_laugh_every_moment_you_live,_for_you'll_find_it_decidedly_difficult_afterwards."_(joe_abercrombie)]` &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["i_love_deadlines._i_love_the_whooshing_noise_they_make_as_they_go_by."_(douglas_adams)]`                        &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["behind_every_great_man_is_a_woman_rolling_her_eyes."_(jim_carrey)]`                                             &lt;fct&gt; ...
## $ `below_are_some_quotes_taken_from_brainyquote.com_or_from_my_private_collection._can_you_indicate_how_much_you_agree_or_disagree_with_each_quote?_["winter_is_coming."_(george_rr_martin)]`                                                                         &lt;fct&gt; ...
## $ `how_many_years_have_you_been_using_r?_please_enter_the_number_of_years_below._if_less_than_a_year,_you_can_use_decimals_(e.g._0.5_for_months)`                                                                                                                     &lt;dbl&gt; ...
## $ `in_which_continent_do_you_currently_live?`                                                                                                                                                                                                                         &lt;chr&gt; ...
## $ `which_generation_do_you_belong_to?`                                                                                                                                                                                                                                &lt;chr&gt; ...
## $ `which_month_do_you_celebrate_your_birthday?`                                                                                                                                                                                                                       &lt;chr&gt; ...
```

---

## Clean up of survey names (1)


```r
raw_surveydata %&gt;% 
* select_all(~str_replace(., ".+set of frequently.+\\[", "freq_load_package_")) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 29
## $ Timestamp                                                                                                                                                                                                                                                           &lt;chr&gt; ...
## $ `Thinking about the last month or so, what are the packages you loaded the most when using R? Please answer max 10 packages you've actively called (not dependencies) and separate using commas.`                                                                   &lt;chr&gt; ...
## $ `freq_load_package_Rcpp]`                                                                                                                                                                                                                                           &lt;fct&gt; ...
## $ `freq_load_package_stringi]`                                                                                                                                                                                                                                        &lt;fct&gt; ...
## $ `freq_load_package_ggplot2]`                                                                                                                                                                                                                                        &lt;fct&gt; ...
## $ `freq_load_package_glue]`                                                                                                                                                                                                                                           &lt;fct&gt; ...
## $ `freq_load_package_rlang]`                                                                                                                                                                                                                                          &lt;fct&gt; ...
## $ `freq_load_package_stringr]`                                                                                                                                                                                                                                        &lt;fct&gt; ...
## $ `freq_load_package_dplyr]`                                                                                                                                                                                                                                          &lt;fct&gt; ...
## $ `freq_load_package_pillar]`                                                                                                                                                                                                                                         &lt;fct&gt; ...
## $ `freq_load_package_fansi]`                                                                                                                                                                                                                                          &lt;fct&gt; ...
## $ `freq_load_package_tibble]`                                                                                                                                                                                                                                         &lt;fct&gt; ...
## $ `freq_load_package_utf8]`                                                                                                                                                                                                                                           &lt;fct&gt; ...
## $ `freq_load_package_jsonlite]`                                                                                                                                                                                                                                       &lt;fct&gt; ...
## $ `freq_load_package_curl]`                                                                                                                                                                                                                                           &lt;fct&gt; ...
## $ `freq_load_package_purrr]`                                                                                                                                                                                                                                          &lt;fct&gt; ...
## $ `freq_load_package_data.table]`                                                                                                                                                                                                                                     &lt;fct&gt; ...
## $ `Specifically about dplyr: can you list below all dplyr functions you can spontaneously think of right now? Separate using commmas. If you don't use dplyr, leave this question blank. And to everyone else, no peeking to documentation or scripts please ;)`      &lt;chr&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Do or not do. There is no try." (Yoda)]`                                                                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["It does not matter what people call you unless they call you pigeon pie and eat you up." (Evelyn Waugh)]`       &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Get your facts first, then you can distort them as you please." (Mark Twain)]`                                  &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["You should laugh every moment you live, for you'll find it decidedly difficult afterwards." (Joe Abercrombie)]` &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["I love deadlines. I love the whooshing noise they make as they go by." (Douglas Adams)]`                        &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Behind every great man is a woman rolling her eyes." (Jim Carrey)]`                                             &lt;fct&gt; ...
## $ `Below are some quotes taken from brainyquote.com or from my private collection. Can you indicate how much you agree or disagree with each quote? ["Winter is coming." (George RR Martin)]`                                                                         &lt;fct&gt; ...
## $ `How many years have you been using R? Please enter the number of years below. If less than a year, you can use decimals (e.g. 0.5 for months)`                                                                                                                     &lt;dbl&gt; ...
## $ `In which continent do you currently live?`                                                                                                                                                                                                                         &lt;chr&gt; ...
## $ `Which generation do you belong to?`                                                                                                                                                                                                                                &lt;chr&gt; ...
## $ `Which month do you celebrate your birthday?`                                                                                                                                                                                                                       &lt;chr&gt; ...
```


---

## Clean up of survey names (2)


```r
surveydata2_cleanvarnames_s &lt;- raw_surveydata_short %&gt;% 
  select_all(~str_replace(., "Thinking .+", "packages_last_month")) %&gt;% 
  select_all(~str_replace(., ".+set of frequently.+\\[", "freq_load_package_")) %&gt;%
  select_all(~str_replace(., ".+quotes.+\\(", "quote_")) %&gt;%
  select_all(~str_replace(., ".+years.+using R.+", "years_R_experience")) %&gt;% 
  select_all(~str_replace(., ".+month .+", "month_born")) %&gt;% 
  select_all(~str_replace(., "Specifically .+", "dplyr_functions_mentioned")) %&gt;% 
  select_all(~str_extract(., "continent")) %&gt;% 
  select_all(~str_extract(., "generation")) %&gt;% 
  select_all(~str_replace(., "\\]", "")) %&gt;% 
  select_all(~str_replace(., "\\)", "")) %&gt;% 
  select_all(~str_replace_all(., " ", "")) %&gt;% 
  select(-Timestamp)
```


---

## Clean up of survey names


```r
glimpse(surveydata2_cleanvarnames_s)
```

```
## Observations: 126
## Variables: 11
## $ packages_last_month       &lt;chr&gt; "dplyr, readxl, jsonlite, tidyr, ggp...
## $ freq_load_package_Rcpp    &lt;fct&gt; Never, Never, Usually, Seldom, Never...
## $ freq_load_package_stringi &lt;fct&gt; Never, Never, About half the time, A...
## $ dplyr_functions_mentioned &lt;chr&gt; "mutate, filter, arrange, select, re...
## $ quote_Yoda                &lt;fct&gt; Slighly disagree, Strongly agree, Sl...
## $ quote_EvelynWaugh         &lt;fct&gt; Slightly agree, Agree nor disagree, ...
## $ quote_GeorgeRRMartin      &lt;fct&gt; Strongly agree, Slightly agree, Agre...
## $ years_R_experience        &lt;dbl&gt; NA, NA, 5, 13, 6, 4, 5, 2, 8, 9, 5, ...
## $ continent                 &lt;chr&gt; "Europe", "North America", "Europe",...
## $ generation                &lt;chr&gt; "Millenials ", "Generation X ", "Mil...
## $ month_born                &lt;chr&gt; "July", "June", "June", "January", "...
```





---

class: inverse, center, middle

## select_if(data, condition_x, function_y)

select and rename all variables that meet condition_x, and rename using function_y


---

## select_if for selecting columns based on characteristics

Selecting all numeric columns


```r
surveydata2_cleanvarnames_s %&gt;% 
* select_if(is.numeric) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 1
## $ years_R_experience &lt;dbl&gt; NA, NA, 5, 13, 6, 4, 5, 2, 8, 9, 5, 1, 6, 4...
```

---

## select_if

To select and modify, add a function:


```r
surveydata2_cleanvarnames_s %&gt;% 
* select_if(is.character, toupper) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 5
## $ PACKAGES_LAST_MONTH       &lt;chr&gt; "dplyr, readxl, jsonlite, tidyr, ggp...
## $ DPLYR_FUNCTIONS_MENTIONED &lt;chr&gt; "mutate, filter, arrange, select, re...
## $ CONTINENT                 &lt;chr&gt; "Europe", "North America", "Europe",...
## $ GENERATION                &lt;chr&gt; "Millenials ", "Generation X ", "Mil...
## $ MONTH_BORN                &lt;chr&gt; "July", "June", "June", "January", "...
```


---

## select_if

To run a function with arguments, make a function on the fly with ~ or funs()


```r
surveydata2_cleanvarnames_s %&gt;% 
* select_if(is.factor, ~str_remove(., ".+_")) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 5
## $ Rcpp           &lt;fct&gt; Never, Never, Usually, Seldom, Never, Seldom, U...
## $ stringi        &lt;fct&gt; Never, Never, About half the time, About half t...
## $ Yoda           &lt;fct&gt; Slighly disagree, Strongly agree, Slightly agre...
## $ EvelynWaugh    &lt;fct&gt; Slightly agree, Agree nor disagree, Agree nor d...
## $ GeorgeRRMartin &lt;fct&gt; Strongly agree, Slightly agree, Agree nor disag...
```


---

## select_if built-in conditions

To scoped if_functions, the following can come in handy:

+ is.character
+ is.factor
+ is.ordered
+ is.numeric
+ is.integer
+ is.double
+ is.logical
+ lubridate::is.Date
+ lubridate::is.POSIXt


---

class: inverse, center, middle

## select_at(data, vars, function_y)

select and rename all variables mentioned in vars, and rename using function_y


---

## select_at to select variables based on their names

Specifying which columns inside vars()


```r
surveydata2_cleanvarnames_s %&gt;% 
* select_at(vars(continent, generation, month_born), toupper) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 3
## $ CONTINENT  &lt;chr&gt; "Europe", "North America", "Europe", "Europe", "Eur...
## $ GENERATION &lt;chr&gt; "Millenials ", "Generation X ", "Millenials ", "Gen...
## $ MONTH_BORN &lt;chr&gt; "July", "June", "June", "January", "July", "March",...
```


---

## Select helper functions

To select based on .focus[partial] names:

+ `starts_with()`
+ `ends_with()`
+ `contains()`

--

To select based on .focus[regex] names:

+ `matches()`

--

To select based on .focus[pre-identified] names:

+ `one_of()` or `!!`



---

## Select helper functions

To select based on .focus[pre-identified] names:


```r
demographics &lt;- c("years_R_experience", "continent", "generation", "month_born")
surveydata2_cleanvarnames_s %&gt;% 
  select(!!demographics) %&gt;% 
  glimpse()
```

```
## Observations: 126
## Variables: 4
## $ years_R_experience &lt;dbl&gt; NA, NA, 5, 13, 6, 4, 5, 2, 8, 9, 5, 1, 6, 4...
## $ continent          &lt;chr&gt; "Europe", "North America", "Europe", "Europ...
## $ generation         &lt;chr&gt; "Millenials ", "Generation X ", "Millenials...
## $ month_born         &lt;chr&gt; "July", "June", "June", "January", "July", ...
```

---

## Select helper functions

To select based on .focus[pre-identified] names:


```r
demographics &lt;- c("years_R_experience", "continent", "generation", "month_born")
surveydata2_cleanvarnames %&gt;% 
  mutate(demographics = 1) %&gt;% 
  select(!!demographics) %&gt;% 
  glimpse()
```

```
## Observations: 126
## Variables: 4
## $ years_R_experience &lt;dbl&gt; NA, NA, 5, 13, 6, 4, 5, 2, 8, 9, 5, 1, 6, 4...
## $ continent          &lt;chr&gt; "Europe", "North America", "Europe", "Europ...
## $ generation         &lt;chr&gt; "Millenials ", "Generation X ", "Millenials...
## $ month_born         &lt;chr&gt; "July", "June", "June", "January", "July", ...
```


---

## select_at with select_helpers

You can use any of the select helpers inside vars():


```r
surveydata2_cleanvarnames %&gt;% 
* select_at(vars(contains("freq")), ~str_remove(., ".+_")) %&gt;%
  glimpse()
```

```
## Observations: 126
## Variables: 15
## $ Rcpp       &lt;fct&gt; Never, Never, Usually, Seldom, Never, Seldom, Usual...
## $ stringi    &lt;fct&gt; Never, Never, About half the time, About half the t...
## $ ggplot2    &lt;fct&gt; Usually, Always, Usually, Usually, Always, Always, ...
## $ glue       &lt;fct&gt; Never, Seldom, About half the time, Seldom, Never, ...
## $ rlang      &lt;fct&gt; Seldom, About half the time, About half the time, N...
## $ stringr    &lt;fct&gt; About half the time, Always, About half the time, U...
## $ dplyr      &lt;fct&gt; Always, Always, About half the time, Always, Seldom...
## $ pillar     &lt;fct&gt; Never, Never, Seldom, Never, Never, Never, Seldom, ...
## $ fansi      &lt;fct&gt; Never, Never, Seldom, Never, Never, Never, Seldom, ...
## $ tibble     &lt;fct&gt; Never, Always, About half the time, Never, Never, A...
## $ utf8       &lt;fct&gt; Never, Seldom, Seldom, Never, Never, Never, Seldom,...
## $ jsonlite   &lt;fct&gt; Seldom, Usually, Seldom, About half the time, Seldo...
## $ curl       &lt;fct&gt; Never, Seldom, Seldom, Seldom, Never, Seldom, Seldo...
## $ purrr      &lt;fct&gt; About half the time, Always, About half the time, N...
## $ data.table &lt;fct&gt; Never, Never, Seldom, Seldom, Never, Seldom, Seldom...
```

---

class: middle

# Part 2
# Transform and summarise

---

# Extra data wrangling:


```r
surveydata3_cleanvartypes &lt;- surveydata2_cleanvarnames %&gt;% 
  separate(packages_last_month, into = paste0("package_mentioned_", 1:12), sep = ",") %&gt;% 
  separate(dplyr_functions_mentioned, into = paste0("dplyr_function_mentioned_", 1:28), sep = ",")
surveydata3_cleanvartypes_s &lt;- select(surveydata3_cleanvartypes, 1:2, 13, 14, 28:30, 56, 57, 63:66)

surveydata3_cleanvartypes
```

```
## # A tibble: 126 x 66
##    package_mentione~ package_mentione~ package_mentione~ package_mentione~
##    &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;            
##  1 dplyr             " readxl"         " jsonlite"       " tidyr"         
##  2 tidyverse         " broom"          " lubridate"      " tidytext"      
##  3 Tidyverse         " recipes"        " plotly"         " h2o"           
##  4 &lt;NA&gt;              &lt;NA&gt;              &lt;NA&gt;              &lt;NA&gt;             
##  5 Ggplot2           " reshape2"       " blogdown"       " googlesheets"  
##  6 Tidyverse         " here"           " plotly"         " knitr"         
##  7 Tidyverse         " odbc"           " dbplyr"         " ggmap"         
##  8 dplyr             " scales"         " ggrepel"        " tidyr"         
##  9 dplyr             " ggplot2"        " knitr"          " sf"            
## 10 Dplyr             " purrr"          " furrr"          " ggplot2"       
## # ... with 116 more rows, and 62 more variables:
## #   package_mentioned_5 &lt;chr&gt;, package_mentioned_6 &lt;chr&gt;,
## #   package_mentioned_7 &lt;chr&gt;, package_mentioned_8 &lt;chr&gt;,
## #   package_mentioned_9 &lt;chr&gt;, package_mentioned_10 &lt;chr&gt;,
## #   package_mentioned_11 &lt;chr&gt;, package_mentioned_12 &lt;chr&gt;,
## #   freq_load_package_Rcpp &lt;fct&gt;, freq_load_package_stringi &lt;fct&gt;,
## #   freq_load_package_ggplot2 &lt;fct&gt;, freq_load_package_glue &lt;fct&gt;,
## #   freq_load_package_rlang &lt;fct&gt;, freq_load_package_stringr &lt;fct&gt;,
## #   freq_load_package_dplyr &lt;fct&gt;, freq_load_package_pillar &lt;fct&gt;,
## #   freq_load_package_fansi &lt;fct&gt;, freq_load_package_tibble &lt;fct&gt;,
## #   freq_load_package_utf8 &lt;fct&gt;, freq_load_package_jsonlite &lt;fct&gt;,
## #   freq_load_package_curl &lt;fct&gt;, freq_load_package_purrr &lt;fct&gt;,
## #   freq_load_package_data.table &lt;fct&gt;, dplyr_function_mentioned_1 &lt;chr&gt;,
## #   dplyr_function_mentioned_2 &lt;chr&gt;, dplyr_function_mentioned_3 &lt;chr&gt;,
## #   dplyr_function_mentioned_4 &lt;chr&gt;, dplyr_function_mentioned_5 &lt;chr&gt;,
## #   dplyr_function_mentioned_6 &lt;chr&gt;, dplyr_function_mentioned_7 &lt;chr&gt;,
## #   dplyr_function_mentioned_8 &lt;chr&gt;, dplyr_function_mentioned_9 &lt;chr&gt;,
## #   dplyr_function_mentioned_10 &lt;chr&gt;, dplyr_function_mentioned_11 &lt;chr&gt;,
## #   dplyr_function_mentioned_12 &lt;chr&gt;, dplyr_function_mentioned_13 &lt;chr&gt;,
## #   dplyr_function_mentioned_14 &lt;chr&gt;, dplyr_function_mentioned_15 &lt;chr&gt;,
## #   dplyr_function_mentioned_16 &lt;chr&gt;, dplyr_function_mentioned_17 &lt;chr&gt;,
## #   dplyr_function_mentioned_18 &lt;chr&gt;, dplyr_function_mentioned_19 &lt;chr&gt;,
## #   dplyr_function_mentioned_20 &lt;chr&gt;, dplyr_function_mentioned_21 &lt;chr&gt;,
## #   dplyr_function_mentioned_22 &lt;chr&gt;, dplyr_function_mentioned_23 &lt;chr&gt;,
## #   dplyr_function_mentioned_24 &lt;chr&gt;, dplyr_function_mentioned_25 &lt;chr&gt;,
## #   dplyr_function_mentioned_26 &lt;chr&gt;, dplyr_function_mentioned_27 &lt;chr&gt;,
## #   dplyr_function_mentioned_28 &lt;chr&gt;, quote_Yoda &lt;fct&gt;,
## #   quote_EvelynWaugh &lt;fct&gt;, quote_MarkTwain &lt;fct&gt;,
## #   quote_JoeAbercrombie &lt;fct&gt;, quote_DouglasAdams &lt;fct&gt;,
## #   quote_JimCarrey &lt;fct&gt;, quote_GeorgeRRMartin &lt;fct&gt;,
## #   years_R_experience &lt;dbl&gt;, continent &lt;chr&gt;, generation &lt;chr&gt;,
## #   month_born &lt;chr&gt;
```


---

class: inverse, center, middle

## mutate_all(data, function_y)

## mutate_if(data, condition_x, function_y)

## mutate_at(data, vars, function_y)

transform observations of multiple/all variables using function_y


---

## Scoped mutate functions


```r
surveydata3_cleanvartypes_s %&gt;% 
  mutate_all(str_trim) %&gt;% 
  mutate_all(tolower)
```

```
## # A tibble: 126 x 13
##    package_mentione~ package_mentione~ freq_load_packag~ freq_load_packag~
##    &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;            
##  1 dplyr             readxl            never             never            
##  2 tidyverse         broom             never             never            
##  3 tidyverse         recipes           usually           about half the t~
##  4 &lt;NA&gt;              &lt;NA&gt;              seldom            about half the t~
##  5 ggplot2           reshape2          never             seldom           
##  6 tidyverse         here              seldom            never            
##  7 tidyverse         odbc              usually           usually          
##  8 dplyr             scales            never             never            
##  9 dplyr             ggplot2           seldom            seldom           
## 10 dplyr             purrr             seldom            seldom           
## # ... with 116 more rows, and 9 more variables:
## #   dplyr_function_mentioned_1 &lt;chr&gt;, dplyr_function_mentioned_2 &lt;chr&gt;,
## #   dplyr_function_mentioned_3 &lt;chr&gt;, quote_Yoda &lt;chr&gt;,
## #   quote_EvelynWaugh &lt;chr&gt;, years_R_experience &lt;chr&gt;, continent &lt;chr&gt;,
## #   generation &lt;chr&gt;, month_born &lt;chr&gt;
```


---

## Scoped mutate functions


```r
agree_answers &lt;- c("Strongly agree", "Slightly agree")
surveydata3_cleanvartypes %&gt;% 
  select(starts_with("quote")) %&gt;% #you don't need this, it's to fit on screen
* mutate_at(vars(starts_with("quote")), ~if_else(. %in% agree_answers, 1, 0))
```

```
## # A tibble: 126 x 7
##    quote_Yoda quote_EvelynWaugh quote_MarkTwain quote_JoeAbercrombie
##         &lt;dbl&gt;             &lt;dbl&gt;           &lt;dbl&gt;                &lt;dbl&gt;
##  1          0                 1               0                    1
##  2          1                 0               0                    1
##  3          1                 0               1                    1
##  4          0                 0               1                    1
##  5          0                 0               1                    1
##  6          1                 1               0                    1
##  7          1                 1               0                    1
##  8          0                 1               1                    1
##  9          1                 0               0                    1
## 10          0                 0               1                    0
## # ... with 116 more rows, and 3 more variables: quote_DouglasAdams &lt;dbl&gt;,
## #   quote_JimCarrey &lt;dbl&gt;, quote_GeorgeRRMartin &lt;dbl&gt;
```

---

class: inverse, middle, center

## summarise_all(data, function_y)

## summarise_if(data, condition_x, function_y)

## summarise_at(data, vars, function_y)


---

## Scoped summarise functions



```r
agree_answers &lt;- c("Strongly agree", "Slightly agree")
survey_quoterecoded &lt;- surveydata3_cleanvartypes %&gt;% 
  mutate_at(vars(contains("quote")), ~if_else(. %in% agree_answers, 1, 0))

survey_quoterecoded %&gt;% 
  summarise_at(vars(contains("quote")), mean) %&gt;% 
  gather(variable, mean)
```

```
## # A tibble: 7 x 2
##   variable              mean
##   &lt;chr&gt;                &lt;dbl&gt;
## 1 quote_Yoda           0.460
## 2 quote_EvelynWaugh    0.325
## 3 quote_MarkTwain      0.579
## 4 quote_JoeAbercrombie 0.706
## 5 quote_DouglasAdams   0.548
## 6 quote_JimCarrey      0.611
## 7 quote_GeorgeRRMartin 0.556
```


---

## Scoped summarise functions

By default, mutate_x and summarise_x overwrite the current variables.  
Add a tag inside funs() to change variable name.


```r
survey_quoterecoded %&gt;% 
  summarise_at(vars(contains("quote")), funs(prop_agree = mean)) %&gt;% 
  gather(variable, mean)
```

```
## # A tibble: 7 x 2
##   variable                         mean
##   &lt;chr&gt;                           &lt;dbl&gt;
## 1 quote_Yoda_prop_agree           0.460
## 2 quote_EvelynWaugh_prop_agree    0.325
## 3 quote_MarkTwain_prop_agree      0.579
## 4 quote_JoeAbercrombie_prop_agree 0.706
## 5 quote_DouglasAdams_prop_agree   0.548
## 6 quote_JimCarrey_prop_agree      0.611
## 7 quote_GeorgeRRMartin_prop_agree 0.556
```


---

## Scoped summarizing with scoped group_by



```r
breakout &lt;- c("continent", "generation")
survey_quoterecoded %&gt;% 
* group_by_at(vars(!!breakout)) %&gt;%
  summarise_at(vars(contains("quote")), mean)
```

```
## # A tibble: 11 x 9
## # Groups:   continent [?]
##    continent    generation     quote_Yoda quote_EvelynWau~ quote_MarkTwain
##    &lt;chr&gt;        &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
##  1 Africa       "Millenials "       0                0.667           1    
##  2 Asia         "Baby Boomers~      1                0               0    
##  3 Asia         "Generation X~      0.5              0.5             1    
##  4 Europe       "Generation X~      0.6              0.267           0.667
##  5 Europe       "Millenials "       0.346            0.346           0.615
##  6 North Ameri~ "Baby Boomers~      1                1               0    
##  7 North Ameri~ "Generation X~      0.481            0.333           0.593
##  8 North Ameri~ "Millenials "       0.513            0.282           0.538
##  9 Oceania      "Generation X~      0.25             0.5             0    
## 10 Oceania      "Millenials "       0.333            0.167           0.667
## 11 South Ameri~ "Millenials "       0.5              0.5             0.5  
## # ... with 4 more variables: quote_JoeAbercrombie &lt;dbl&gt;,
## #   quote_DouglasAdams &lt;dbl&gt;, quote_JimCarrey &lt;dbl&gt;,
## #   quote_GeorgeRRMartin &lt;dbl&gt;
```



---

class: inverse, middle, center

## filter_all(data, filter_criteria)

## filter_if(data, condition_x, filter_criteria)

## filter_at(data, vars, filter_criteria)


---

## scoped filter functions:

Use any_vars() if condition needs to be true across 1 or more columns ("OR")



```r
surveydata3_cleanvartypes %&gt;% 
  filter_all(any_vars(str_detect(., "jsonlite")))
```

```
## # A tibble: 3 x 66
##   package_mentioned~ package_mentione~ package_mentione~ package_mentione~
##   &lt;chr&gt;              &lt;chr&gt;             &lt;chr&gt;             &lt;chr&gt;            
## 1 dplyr              " readxl"         " jsonlite"       " tidyr"         
## 2 Tidyverse          " tidytext"       " lubridate"      " plumber"       
## 3 Tidyverse          jsonlite          ggplot            readxl           
## # ... with 62 more variables: package_mentioned_5 &lt;chr&gt;,
## #   package_mentioned_6 &lt;chr&gt;, package_mentioned_7 &lt;chr&gt;,
## #   package_mentioned_8 &lt;chr&gt;, package_mentioned_9 &lt;chr&gt;,
## #   package_mentioned_10 &lt;chr&gt;, package_mentioned_11 &lt;chr&gt;,
## #   package_mentioned_12 &lt;chr&gt;, freq_load_package_Rcpp &lt;fct&gt;,
## #   freq_load_package_stringi &lt;fct&gt;, freq_load_package_ggplot2 &lt;fct&gt;,
## #   freq_load_package_glue &lt;fct&gt;, freq_load_package_rlang &lt;fct&gt;,
## #   freq_load_package_stringr &lt;fct&gt;, freq_load_package_dplyr &lt;fct&gt;,
## #   freq_load_package_pillar &lt;fct&gt;, freq_load_package_fansi &lt;fct&gt;,
## #   freq_load_package_tibble &lt;fct&gt;, freq_load_package_utf8 &lt;fct&gt;,
## #   freq_load_package_jsonlite &lt;fct&gt;, freq_load_package_curl &lt;fct&gt;,
## #   freq_load_package_purrr &lt;fct&gt;, freq_load_package_data.table &lt;fct&gt;,
## #   dplyr_function_mentioned_1 &lt;chr&gt;, dplyr_function_mentioned_2 &lt;chr&gt;,
## #   dplyr_function_mentioned_3 &lt;chr&gt;, dplyr_function_mentioned_4 &lt;chr&gt;,
## #   dplyr_function_mentioned_5 &lt;chr&gt;, dplyr_function_mentioned_6 &lt;chr&gt;,
## #   dplyr_function_mentioned_7 &lt;chr&gt;, dplyr_function_mentioned_8 &lt;chr&gt;,
## #   dplyr_function_mentioned_9 &lt;chr&gt;, dplyr_function_mentioned_10 &lt;chr&gt;,
## #   dplyr_function_mentioned_11 &lt;chr&gt;, dplyr_function_mentioned_12 &lt;chr&gt;,
## #   dplyr_function_mentioned_13 &lt;chr&gt;, dplyr_function_mentioned_14 &lt;chr&gt;,
## #   dplyr_function_mentioned_15 &lt;chr&gt;, dplyr_function_mentioned_16 &lt;chr&gt;,
## #   dplyr_function_mentioned_17 &lt;chr&gt;, dplyr_function_mentioned_18 &lt;chr&gt;,
## #   dplyr_function_mentioned_19 &lt;chr&gt;, dplyr_function_mentioned_20 &lt;chr&gt;,
## #   dplyr_function_mentioned_21 &lt;chr&gt;, dplyr_function_mentioned_22 &lt;chr&gt;,
## #   dplyr_function_mentioned_23 &lt;chr&gt;, dplyr_function_mentioned_24 &lt;chr&gt;,
## #   dplyr_function_mentioned_25 &lt;chr&gt;, dplyr_function_mentioned_26 &lt;chr&gt;,
## #   dplyr_function_mentioned_27 &lt;chr&gt;, dplyr_function_mentioned_28 &lt;chr&gt;,
## #   quote_Yoda &lt;fct&gt;, quote_EvelynWaugh &lt;fct&gt;, quote_MarkTwain &lt;fct&gt;,
## #   quote_JoeAbercrombie &lt;fct&gt;, quote_DouglasAdams &lt;fct&gt;,
## #   quote_JimCarrey &lt;fct&gt;, quote_GeorgeRRMartin &lt;fct&gt;,
## #   years_R_experience &lt;dbl&gt;, continent &lt;chr&gt;, generation &lt;chr&gt;,
## #   month_born &lt;chr&gt;
```


---

## scoped filter functions:

Use all_vars() if condition needs to be true across all columns ("AND")


```r
surveydata3_cleanvartypes %&gt;% 
  filter_all(all_vars(str_detect(., "jsonlite")))
```

```
## # A tibble: 0 x 66
## # ... with 66 variables: package_mentioned_1 &lt;chr&gt;,
## #   package_mentioned_2 &lt;chr&gt;, package_mentioned_3 &lt;chr&gt;,
## #   package_mentioned_4 &lt;chr&gt;, package_mentioned_5 &lt;chr&gt;,
## #   package_mentioned_6 &lt;chr&gt;, package_mentioned_7 &lt;chr&gt;,
## #   package_mentioned_8 &lt;chr&gt;, package_mentioned_9 &lt;chr&gt;,
## #   package_mentioned_10 &lt;chr&gt;, package_mentioned_11 &lt;chr&gt;,
## #   package_mentioned_12 &lt;chr&gt;, freq_load_package_Rcpp &lt;fct&gt;,
## #   freq_load_package_stringi &lt;fct&gt;, freq_load_package_ggplot2 &lt;fct&gt;,
## #   freq_load_package_glue &lt;fct&gt;, freq_load_package_rlang &lt;fct&gt;,
## #   freq_load_package_stringr &lt;fct&gt;, freq_load_package_dplyr &lt;fct&gt;,
## #   freq_load_package_pillar &lt;fct&gt;, freq_load_package_fansi &lt;fct&gt;,
## #   freq_load_package_tibble &lt;fct&gt;, freq_load_package_utf8 &lt;fct&gt;,
## #   freq_load_package_jsonlite &lt;fct&gt;, freq_load_package_curl &lt;fct&gt;,
## #   freq_load_package_purrr &lt;fct&gt;, freq_load_package_data.table &lt;fct&gt;,
## #   dplyr_function_mentioned_1 &lt;chr&gt;, dplyr_function_mentioned_2 &lt;chr&gt;,
## #   dplyr_function_mentioned_3 &lt;chr&gt;, dplyr_function_mentioned_4 &lt;chr&gt;,
## #   dplyr_function_mentioned_5 &lt;chr&gt;, dplyr_function_mentioned_6 &lt;chr&gt;,
## #   dplyr_function_mentioned_7 &lt;chr&gt;, dplyr_function_mentioned_8 &lt;chr&gt;,
## #   dplyr_function_mentioned_9 &lt;chr&gt;, dplyr_function_mentioned_10 &lt;chr&gt;,
## #   dplyr_function_mentioned_11 &lt;chr&gt;, dplyr_function_mentioned_12 &lt;chr&gt;,
## #   dplyr_function_mentioned_13 &lt;chr&gt;, dplyr_function_mentioned_14 &lt;chr&gt;,
## #   dplyr_function_mentioned_15 &lt;chr&gt;, dplyr_function_mentioned_16 &lt;chr&gt;,
## #   dplyr_function_mentioned_17 &lt;chr&gt;, dplyr_function_mentioned_18 &lt;chr&gt;,
## #   dplyr_function_mentioned_19 &lt;chr&gt;, dplyr_function_mentioned_20 &lt;chr&gt;,
## #   dplyr_function_mentioned_21 &lt;chr&gt;, dplyr_function_mentioned_22 &lt;chr&gt;,
## #   dplyr_function_mentioned_23 &lt;chr&gt;, dplyr_function_mentioned_24 &lt;chr&gt;,
## #   dplyr_function_mentioned_25 &lt;chr&gt;, dplyr_function_mentioned_26 &lt;chr&gt;,
## #   dplyr_function_mentioned_27 &lt;chr&gt;, dplyr_function_mentioned_28 &lt;chr&gt;,
## #   quote_Yoda &lt;fct&gt;, quote_EvelynWaugh &lt;fct&gt;, quote_MarkTwain &lt;fct&gt;,
## #   quote_JoeAbercrombie &lt;fct&gt;, quote_DouglasAdams &lt;fct&gt;,
## #   quote_JimCarrey &lt;fct&gt;, quote_GeorgeRRMartin &lt;fct&gt;,
## #   years_R_experience &lt;dbl&gt;, continent &lt;chr&gt;, generation &lt;chr&gt;,
## #   month_born &lt;chr&gt;
```



---

class: inverse

# In short:

&lt;br&gt;

### dplyr*_all: do something to all variables

### dplyr*_if: 	do something to a set of variables that were selected based on their characteristics

### dplyr*_at: do something to a set of variables that were selected based on their variable names



Replace * with select, rename, mutate, transmute, filter, summarise, group_by, arrange


---

class: middle

# Part 6
# Miscellaneous

---

class: middle, center

# Unfortunately time's up

--

Nifty tricks like na_if(), case_when(), recode(), near(), everything(), rowwise(), add_count() .... are for another time. Or for your own exploration.


---

# Resources

+ dplyr documentation!

--

## My tutorials
+ &lt;a href="http://bit.ly/dplyr_1"&gt;bit.ly/dplyr_1 &lt;/a&gt;: selecting columns
+ &lt;a href="http://bit.ly/dplyr_2"&gt;bit.ly/dplyr_2 &lt;/a&gt;: transforming observations
+ &lt;a href="http://bit.ly/dplyr_3"&gt;bit.ly/dplyr_3 &lt;/a&gt;: filtering
+ &lt;a href="http://bit.ly/dplyr_4"&gt;bit.ly/dplyr_4 &lt;/a&gt;: summarising


## Materials from today
+ &lt;a href="http://bit.ly/dplyr_slides"&gt;bit.ly/dplyr_slides &lt;/a&gt;:  all the material for this talk (as of tomorrow evening)


---

class: inverse, left, middle

# Thanks!

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;


Twitter: &lt;a href="http://www.twitter.com/suzanbaert"&gt; @suzanbaert &lt;/a&gt;  
Blog: &lt;a href="http://bit.ly/suzan_blog"&gt; bit.ly/suzan_blog&lt;/a&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
